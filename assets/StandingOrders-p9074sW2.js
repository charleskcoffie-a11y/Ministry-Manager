import{c as d,u as J,f as X,r,j as e,X as K}from"./index-DjP7dUMH.js";import{s as k}from"./supabaseClient-B6bhcLjp.js";import{e as W}from"./geminiService-C5glO8G0.js";import{A as V}from"./arrow-left-CUR_DFCt.js";import{S as Y}from"./search-zNlIoLwv.js";import{C as Z}from"./circle-check-hWmEiH4g.js";import{F as ee}from"./file-text-R5oTv0Xe.js";/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],b=d("bookmark",te);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],u=d("bot",se);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"m14 13-8.381 8.38a1 1 0 0 1-3.001-3l8.384-8.381",key:"pgg06f"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m21.5 10.5-8-8",key:"a17d9x"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m8.5 7.5 8 8",key:"1oyaui"}]],re=d("gavel",ae);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]],oe=d("library",le);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],B=d("scale",ne);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],ce=d("scroll-text",ie);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M3 5h18",key:"1u36vt"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 19h18",key:"awlh7x"}]],xe=d("text-align-justify",de),ye=()=>{const m=J(),S=X(),U=new URLSearchParams(m.search).get("q")||"",[_,C]=r.useState([]),[G,g]=r.useState(!0),[c,H]=r.useState(!1),[i,$]=r.useState(!1),[h,M]=r.useState([]),[F,L]=r.useState(""),[he,R]=r.useState(!1),[fe,pe]=r.useState(!1),[O,v]=r.useState(!1),[l,E]=r.useState(U),[s,j]=r.useState(null),[n,z]=r.useState(null),[A,N]=r.useState(""),[D,P]=r.useState(!1),Q=r.useRef(null);r.useEffect(()=>{const t=new URLSearchParams(m.search);l?t.set("q",l):t.delete("q");const a=t.toString(),o=new URLSearchParams(m.search).toString();a!==o&&S({search:a},{replace:!0})},[l,S,m.search]),r.useEffect(()=>{(async()=>{try{R(!0);const{data:a,error:o}=await k.from("uploaded_documents").select("*").eq("id","standing_orders").single();o&&o.code!=="PGRST116"&&console.error("Error fetching saved document:",o),a&&a.content&&(console.log("Restored document:",a.filename),L(a.filename),M(a.content),$(!0))}catch(a){console.error("Unexpected error loading document:",a)}finally{R(!1),g(!1)}})()},[]);const f=t=>{const a=t.match(/^s[\.\s]*o[\.\s]*(\d+)/i);return a?a[1]:null},p=r.useCallback(async()=>{if(i)return;g(!0);let t=k.from("standing_orders").select("*");const a=f(l);a?t=t.ilike("code",`%${a}%`):l.trim().length>0&&(t=t.or(`title.ilike.%${l}%,content.ilike.%${l}%`)),c&&(t=t.eq("is_favorite",!0));const{data:o,error:x}=await t.order("code",{ascending:!0});!x&&o&&C(o),g(!1)},[l,i,c]);r.useEffect(()=>{const t=setTimeout(()=>{p()},500);return()=>clearTimeout(t)},[l,p,c]);const w=async(t,a)=>{t.stopPropagation();const o=!a.is_favorite;C(x=>x.map(y=>y.id===a.id?{...y,is_favorite:o}:y)),(s==null?void 0:s.id)===a.id&&j({...s,is_favorite:o});try{await k.from("standing_orders").update({is_favorite:o}).eq("id",a.id)}catch(x){console.error("Error updating favorite",x),p()}},q=async(t,a="Reference")=>{P(!0);const o=await W();N(o),P(!1)},I=()=>{$(!1),M([]),L(""),E(""),v(!1),setTimeout(p,0)},T=h.filter(t=>{if(!l)return!0;const a=f(l);return a?new RegExp(`s[\\.\\s]*o[\\.\\s]*${a}`,"i").test(t.text):t.text.toLowerCase().includes(l.toLowerCase())});return O&&i?e.jsxs("div",{className:"h-[calc(100vh-100px)] flex flex-col bg-stone-50 rounded-lg shadow-lg border border-stone-200 animate-fade-in relative",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-stone-200 flex items-center justify-between bg-white sticky top-0 z-20 rounded-t-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>v(!1),className:"flex items-center gap-2 px-4 py-2 text-stone-600 hover:bg-stone-100 rounded-lg transition-colors font-serif",children:[e.jsx(V,{className:"w-5 h-5"})," Back to Search"]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"font-bold text-stone-800 text-lg flex items-center gap-2 font-serif",children:[e.jsx(ce,{className:"w-5 h-5 text-amber-600"}),F]}),e.jsx("p",{className:"text-sm text-stone-500",children:"Full Text Mode"})]})]}),n&&e.jsxs("div",{className:"hidden sm:block text-sm font-medium text-stone-600 bg-stone-100 px-4 py-2 rounded-full border border-stone-200",children:["Jumped to result: ",f(l)?`SO ${f(l)}`:"Selection"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8 bg-stone-100/50",ref:Q,children:e.jsxs("div",{className:"max-w-4xl mx-auto bg-white p-12 shadow-md min-h-full rounded-sm border border-stone-200 relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-slate-900"}),h.length===0&&e.jsx("p",{className:"text-stone-400 text-xl font-serif text-center italic mt-10",children:"No content loaded."}),h.map((t,a)=>e.jsxs("div",{id:t.id,className:`mb-6 transition-all duration-500 ${(n==null?void 0:n.id)===t.id?"p-6 -mx-6 rounded bg-amber-50/50 border-l-4 border-amber-500":""}`,children:[t.page&&a>0&&h[a-1].page!==t.page&&e.jsxs("div",{className:"flex items-center gap-4 my-8 opacity-50",children:[e.jsx("div",{className:"h-px bg-stone-300 flex-1"}),e.jsxs("span",{className:"text-xs font-serif font-bold text-stone-500 uppercase tracking-widest",children:["Page ",t.page]}),e.jsx("div",{className:"h-px bg-stone-300 flex-1"})]}),e.jsx("p",{className:"text-stone-800 leading-loose text-lg font-serif whitespace-pre-wrap",children:t.text})]},t.id))]})})]}):e.jsxs("div",{className:"h-[calc(100vh-100px)] flex flex-col bg-stone-50/50",children:[e.jsxs("div",{className:"mb-6 bg-slate-900 rounded-2xl shadow-lg p-8 relative overflow-hidden border-b-4 border-amber-600",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/black-scales.png')] opacity-10"}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-end gap-6",children:[e.jsxs("div",{className:"flex gap-5 items-start",children:[e.jsx("div",{className:"bg-white/10 p-3 rounded-xl border border-white/10 backdrop-blur-sm",children:e.jsx(re,{className:"w-8 h-8 text-amber-500"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-serif font-bold text-white tracking-wide mb-1",children:"Standing Orders & Constitution"}),e.jsx("p",{className:"text-slate-400 font-light text-lg",children:"Governance • Rules • Legal Framework"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:i&&e.jsxs("button",{onClick:I,className:"flex items-center gap-2 px-5 py-3 bg-red-500/20 border border-red-500/30 text-red-200 rounded-lg hover:bg-red-500/30 transition-all text-sm font-medium",children:[e.jsx(K,{className:"w-5 h-5"})," Close Reader"]})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row gap-6 overflow-hidden",children:[e.jsxs("div",{className:`w-full md:w-1/3 lg:w-1/4 bg-white rounded-xl shadow-sm border border-stone-200 flex flex-col overflow-hidden ${s||n?"hidden md:flex":"flex"}`,children:[e.jsxs("div",{className:"p-4 border-b border-stone-100 bg-stone-50/50 space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Y,{className:"absolute left-3 top-3 h-5 w-5 text-stone-400"}),e.jsx("input",{type:"text",placeholder:"Search section, rule, or code...",className:"w-full pl-10 pr-4 py-2.5 bg-white border border-stone-200 rounded-lg shadow-sm focus:ring-2 focus:ring-slate-800 focus:border-slate-800 outline-none text-stone-700 font-medium placeholder-stone-400",value:l,onChange:t=>E(t.target.value)})]}),!i&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-bold text-stone-500 uppercase tracking-widest",children:c?"Saved Items":"All Sections"}),e.jsxs("button",{onClick:()=>H(!c),className:`text-xs font-bold px-3 py-1.5 rounded-md flex items-center gap-1.5 transition-colors border ${c?"bg-amber-50 text-amber-700 border-amber-200":"bg-white text-stone-500 border-stone-200 hover:border-stone-300"}`,children:[e.jsx(b,{className:`w-3 h-3 ${c?"fill-amber-600":""}`}),"Favorites"]})]}),i&&e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-emerald-700 bg-emerald-50 px-3 py-1.5 rounded-md border border-emerald-100",children:[e.jsx(Z,{className:"w-3 h-3"}),"Viewing: ",e.jsx("span",{className:"font-bold truncate max-w-[150px]",children:F})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto bg-white",children:[!i&&e.jsx(e.Fragment,{children:G?e.jsx("div",{className:"p-8 text-center text-stone-400 text-sm font-serif italic",children:"Loading statutes..."}):_.length===0?e.jsxs("div",{className:"p-10 text-center flex flex-col items-center opacity-60",children:[e.jsx(B,{className:"w-10 h-10 text-stone-300 mb-3"}),e.jsx("p",{className:"text-stone-500 font-medium",children:"No sections found."})]}):e.jsx("div",{className:"divide-y divide-stone-100",children:_.map(t=>e.jsxs("div",{onClick:()=>{j(t),N("")},className:`group px-5 py-4 cursor-pointer hover:bg-stone-50 transition-all border-l-4 ${(s==null?void 0:s.id)===t.id?"bg-amber-50/40 border-amber-500":"border-transparent hover:border-stone-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:`text-xs font-bold uppercase tracking-wider ${(s==null?void 0:s.id)===t.id?"text-amber-700":"text-slate-500"}`,children:t.code}),e.jsx("button",{onClick:a=>w(a,t),className:`p-1 rounded-full transition-colors ${t.is_favorite?"text-amber-500":"text-slate-300 hover:text-slate-500 hover:bg-slate-100"}`,children:e.jsx(b,{className:`w-4 h-4 ${t.is_favorite?"fill-amber-500":""}`})})]}),e.jsx("h3",{className:`font-serif font-bold text-base leading-tight mb-1 ${(s==null?void 0:s.id)===t.id?"text-slate-900":"text-stone-700"}`,children:t.title}),e.jsx("p",{className:"text-xs text-stone-400 line-clamp-2 font-serif leading-relaxed",children:t.content})]},t.id))})}),i&&e.jsx("div",{className:"divide-y divide-stone-100",children:T.length===0?e.jsx("div",{className:"p-10 text-center text-stone-400 text-sm",children:"No matches in document."}):T.map(t=>e.jsxs("div",{onClick:()=>{z(t),N("")},className:`px-5 py-4 cursor-pointer hover:bg-stone-50 transition-all border-l-4 ${(n==null?void 0:n.id)===t.id?"bg-amber-50/40 border-amber-500":"border-transparent"}`,children:[t.page&&e.jsxs("span",{className:"text-[10px] font-bold text-stone-400 uppercase mb-1 block",children:["Page ",t.page]}),e.jsx("p",{className:"text-sm text-stone-700 font-serif line-clamp-3 leading-relaxed",children:t.text})]},t.id))})]})]}),e.jsxs("div",{className:`flex-[2] bg-white rounded-xl shadow-sm border border-stone-200 overflow-hidden relative flex flex-col ${s||n?"flex":"hidden md:flex"}`,children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none opacity-[0.03]",children:e.jsx(B,{className:"w-96 h-96 text-slate-900"})}),e.jsx("div",{className:"md:hidden bg-stone-50 p-4 border-b border-stone-200 sticky top-0 z-10",children:e.jsxs("button",{onClick:()=>{j(null),z(null)},className:"flex items-center gap-2 text-stone-600 font-medium",children:[e.jsx(V,{className:"w-5 h-5"})," Back to List"]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-8 md:p-12 relative z-0",children:[s&&!i&&e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-start border-b-2 border-slate-900 pb-6 mb-8",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm font-bold text-amber-600 uppercase tracking-widest mb-2",children:"Standing Order"}),e.jsx("h2",{className:"text-5xl font-serif font-bold text-slate-900",children:s.code})]}),e.jsxs("div",{className:"flex flex-col gap-2 items-end",children:[e.jsxs("button",{onClick:t=>w(t,s),className:`flex items-center gap-2 px-4 py-2 rounded-full border text-sm font-bold transition-all ${s.is_favorite?"bg-amber-50 text-amber-700 border-amber-200":"bg-white text-stone-400 border-stone-200 hover:border-stone-300"}`,children:[e.jsx(b,{className:`w-4 h-4 ${s.is_favorite?"fill-amber-600":""}`}),s.is_favorite?"Saved":"Save Section"]}),e.jsxs("button",{onClick:()=>q(s.content,s.code),className:"flex items-center gap-2 px-4 py-2 bg-slate-100 text-slate-600 rounded-full hover:bg-slate-200 text-sm font-bold transition",children:[e.jsx(u,{className:"w-4 h-4"})," Explain"]})]})]}),e.jsx("h3",{className:"text-2xl font-serif font-bold text-slate-800 mb-6",children:s.title}),e.jsx("div",{className:"prose prose-lg max-w-none prose-p:font-serif prose-p:text-stone-800 prose-p:leading-loose",children:e.jsx("p",{children:s.content})}),s.tags&&e.jsx("div",{className:"mt-12 pt-6 border-t border-stone-200 flex gap-2",children:s.tags.map(t=>e.jsx("span",{className:"px-3 py-1 bg-stone-100 text-stone-500 rounded text-xs font-bold uppercase",children:t},t))}),e.jsx("div",{className:"mt-8 pt-8 border-t border-stone-200 flex justify-center",children:e.jsxs("button",{onClick:t=>w(t,s),className:`flex items-center gap-3 px-8 py-3 rounded-full font-bold text-lg transition-all shadow-sm transform hover:-translate-y-0.5 ${s.is_favorite?"bg-amber-100 text-amber-800 hover:bg-amber-200 border border-amber-200":"bg-slate-800 text-white hover:bg-slate-700"}`,children:[e.jsx(b,{className:`w-5 h-5 ${s.is_favorite?"fill-amber-800":""}`}),s.is_favorite?"Remove from Favorites":"Add to Favorites"]})})]}),n&&i&&e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 pb-4 border-b border-stone-200",children:[e.jsxs("div",{className:"flex items-center gap-3 text-stone-500",children:[e.jsx(ee,{className:"w-6 h-6"}),e.jsx("span",{className:"font-serif italic",children:"Excerpt from uploaded document"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>v(!0),className:"flex items-center gap-2 px-4 py-2 bg-slate-800 text-white rounded-lg hover:bg-slate-900 text-sm font-bold transition shadow-sm",children:[e.jsx(xe,{className:"w-4 h-4"})," Read Full Context"]}),e.jsxs("button",{onClick:()=>q(n.text,"Document Excerpt"),className:"flex items-center gap-2 px-4 py-2 bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-200 text-sm font-bold transition",children:[e.jsx(u,{className:"w-4 h-4"})," Explain"]})]})]}),e.jsx("div",{className:"bg-amber-50/30 p-8 rounded border-l-4 border-amber-300",children:e.jsx("p",{className:"font-serif text-xl leading-loose text-slate-800 whitespace-pre-wrap",children:n.text})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("p",{className:"text-stone-400 italic font-serif text-sm",children:'Click "Read Full Context" to view the surrounding pages.'})})]}),!s&&!n&&e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-stone-300",children:[e.jsx(oe,{className:"w-32 h-32 mb-6 opacity-20"}),e.jsx("h3",{className:"text-2xl font-serif font-bold text-stone-400 mb-2",children:"Select a Section"}),e.jsx("p",{className:"font-serif italic",children:"Choose an item from the table of contents to begin reading."})]}),(s||n)&&e.jsxs("div",{className:"mt-12 max-w-3xl mx-auto",children:[D&&e.jsxs("div",{className:"p-6 bg-slate-50 rounded border border-slate-100 flex items-center gap-3 animate-pulse",children:[e.jsx(u,{className:"w-5 h-5 text-slate-400"}),e.jsx("span",{className:"text-slate-500 font-medium",children:"Analyzing legal text..."})]}),A&&!D&&e.jsxs("div",{className:"p-8 bg-slate-50 rounded-lg border border-slate-200 shadow-inner",children:[e.jsxs("h4",{className:"font-bold flex items-center gap-2 mb-4 text-slate-700 uppercase tracking-widest text-xs",children:[e.jsx(u,{className:"w-4 h-4 text-amber-600"}),"AI Simplification"]}),e.jsx("p",{className:"text-slate-700 leading-relaxed font-medium",children:A})]})]})]})]})]})]})};export{ye as default};
