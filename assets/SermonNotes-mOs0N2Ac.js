import{r as u,j as e,P as J,X as W,d as M,l as X,a as G}from"./index-BgenSf1I.js";import{s as x}from"./supabaseClient-Cz1ETm7S.js";import{P as A}from"./plus-CoBEYjcu.js";import{S as V}from"./search-R4CfColv.js";import{U as Y}from"./user-CV3XbVfC.js";import{T as U}from"./trash-2-9s6o-Ntw.js";import{C as Z}from"./chevron-left-CK8XVs5n.js";import{S as $}from"./save-vBAa8MGd.js";import{C as c}from"./chevron-up-CKujAhGt.js";import{C as d}from"./chevron-down-DRYaZ0dn.js";import{L as ee}from"./list-CAHXj0LM.js";const me=()=>{var T;const[_,g]=u.useState("list"),[w,h]=u.useState(!1),[v,F]=u.useState([]),[y,C]=u.useState(!1),[j,k]=u.useState(""),S={id:"",preacher:"",note_date:new Date().toISOString().split("T")[0],location:"",sermon_title:"",main_scripture:"",opening_remarks:"",passage_context:"",key_themes:"",key_doctrines:"",theological_strengths:"",theological_questions:"",tone_atmosphere:"",use_of_scripture:"",use_of_stories:"",audience_engagement:"",flow_transitions:"",memorable_phrases:"",minister_lessons:"",personal_challenge:"",application_to_preaching:"",pastoral_insights:"",calls_to_action:"",spiritual_challenges:"",practical_applications:"",prayer_points:"",closing_scripture:"",central_message_summary:"",final_memorable_line:"",followup_scriptures:"",followup_topics:"",followup_people:"",followup_ministry_ideas:"",points:[{point_number:1,main_point:"",supporting_scripture:"",key_quotes:"",illustrations:"",ministry_emphasis:""},{point_number:2,main_point:"",supporting_scripture:"",key_quotes:"",illustrations:"",ministry_emphasis:""},{point_number:3,main_point:"",supporting_scripture:"",key_quotes:"",illustrations:"",ministry_emphasis:""}]},[t,l]=u.useState(S),[r,P]=u.useState({1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!1}),p=s=>{P(a=>({...a,[s]:!a[s]}))};u.useEffect(()=>{N()},[]);const N=async()=>{h(!0);const{data:s,error:a}=await x.from("sermon_talk_notes").select("*").order("note_date",{ascending:!1});s&&!a&&F(s),h(!1)},I=async s=>{h(!0);const{data:a,error:i}=await x.from("sermon_talk_notes").select("*").eq("id",s).single();if(i||!a){alert("Error fetching note details."),h(!1);return}const{data:n,error:m}=await x.from("sermon_talk_points").select("*").eq("note_id",s).order("point_number",{ascending:!0});l({...a,points:n||[]}),g("edit"),h(!1)},B=async()=>{if(!t.sermon_title&&!t.preacher){alert("Please enter at least a Title or Preacher.");return}C(!0);try{const{points:s,id:a,created_at:i,...n}=t;let m=a;const{data:K,error:E}=await x.from("sermon_talk_notes").upsert(a?{id:a,...n}:n).select().single();if(E)throw E;if(m=K.id,m&&(await x.from("sermon_talk_points").delete().eq("note_id",m),t.points&&t.points.length>0)){const z=t.points.map((f,H)=>({note_id:m,point_number:H+1,main_point:f.main_point||"",supporting_scripture:f.supporting_scripture||"",key_quotes:f.key_quotes||"",illustrations:f.illustrations||"",ministry_emphasis:f.ministry_emphasis||""})),{error:D}=await x.from("sermon_talk_points").insert(z);if(D)throw D}alert("Note saved successfully."),g("list"),N()}catch(s){console.error("Save Error:",s),alert("Failed to save: "+s.message)}finally{C(!1)}},O=async(s,a)=>{a.stopPropagation(),confirm("Are you sure you want to delete this note?")&&(await x.from("sermon_talk_notes").delete().eq("id",s),N())},b=(s,a,i)=>{const n=[...t.points||[]];n[s]={...n[s],[a]:i},l({...t,points:n})},R=()=>{var s;l({...t,points:[...t.points||[],{point_number:(((s=t.points)==null?void 0:s.length)||0)+1,main_point:"",supporting_scripture:"",key_quotes:"",illustrations:"",ministry_emphasis:""}]})},Q=s=>{const a=[...t.points||[]];a.splice(s,1),l({...t,points:a})},L=(s,a)=>{var m;if(a==="up"&&s===0||a==="down"&&s===(((m=t.points)==null?void 0:m.length)||0)-1)return;const i=[...t.points||[]],n=i[s];i[s]=i[s+(a==="up"?-1:1)],i[s+(a==="up"?-1:1)]=n,l({...t,points:i})},q=v.filter(s=>{const a=j.toLowerCase();return s.sermon_title&&s.sermon_title.toLowerCase().includes(a)||s.preacher&&s.preacher.toLowerCase().includes(a)||s.location&&s.location.toLowerCase().includes(a)||s.main_scripture&&s.main_scripture.toLowerCase().includes(a)});return _==="list"?e.jsxs("div",{className:"max-w-4xl mx-auto pb-20 animate-fade-in space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-200",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-serif font-bold text-slate-800 flex items-center gap-3",children:[e.jsx(J,{className:"w-8 h-8 text-indigo-600"})," Sermon Notes"]}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Capture insights, theology, and reflections."})]}),e.jsxs("button",{onClick:()=>{l(S),g("edit"),P({1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!1})},className:"flex items-center gap-2 px-6 py-3 bg-indigo-600 text-white rounded-full hover:bg-indigo-700 font-bold shadow-md transition-all active:scale-95",children:[e.jsx(A,{className:"w-5 h-5"})," New Note"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-3 top-3.5 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search notes by title, preacher, or scripture...",className:"w-full pl-10 pr-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all shadow-sm",value:j,onChange:s=>k(s.target.value)}),j&&e.jsx("button",{onClick:()=>k(""),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-100 rounded-full",children:e.jsx(W,{className:"w-4 h-4"})})]}),w?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(M,{className:"w-10 h-10 animate-spin text-indigo-300"})}):q.length===0?e.jsxs("div",{className:"text-center py-20 bg-slate-50 rounded-2xl border border-dashed border-slate-300",children:[e.jsx(X,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-500 font-medium",children:j?"No matching notes found.":"No sermon notes yet."})]}):e.jsx("div",{className:"grid gap-4",children:q.map(s=>e.jsxs("div",{onClick:()=>I(s.id),className:"bg-white p-5 rounded-xl border border-slate-100 shadow-sm hover:shadow-md transition-all cursor-pointer group flex justify-between items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:[e.jsx(G,{className:"w-3 h-3"}),new Date(s.note_date).toLocaleDateString(),s.location&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-slate-300",children:"â€¢"})," ",s.location]})]}),e.jsx("h3",{className:"text-lg font-bold text-slate-800 group-hover:text-indigo-600 transition-colors",children:s.sermon_title||"Untitled Sermon"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-slate-600",children:[e.jsx(Y,{className:"w-4 h-4 text-indigo-400"}),s.preacher||"Unknown Preacher"]})]}),e.jsx("button",{onClick:a=>O(s.id,a),className:"p-2 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors opacity-0 group-hover:opacity-100",children:e.jsx(U,{className:"w-5 h-5"})})]},s.id))})]}):e.jsxs("div",{className:"max-w-3xl mx-auto pb-24 animate-fade-in",children:[e.jsxs("div",{className:"sticky top-0 z-20 bg-gray-50/95 backdrop-blur-sm border-b border-gray-200 py-3 mb-6 flex justify-between items-center",children:[e.jsxs("button",{onClick:()=>g("list"),className:"flex items-center gap-1 text-slate-600 hover:text-slate-900 px-2 py-1 rounded-lg hover:bg-slate-200 transition-colors",children:[e.jsx(Z,{className:"w-5 h-5"})," Back"]}),e.jsx("span",{className:"font-bold text-slate-700 hidden sm:block",children:t.id?"Edit Note":"New Note"}),e.jsxs("button",{onClick:B,disabled:y,className:"flex items-center gap-2 px-5 py-2 bg-indigo-600 text-white rounded-full hover:bg-indigo-700 font-bold shadow-sm transition-all active:scale-95 disabled:opacity-50",children:[y?e.jsx(M,{className:"w-4 h-4 animate-spin"}):e.jsx($,{className:"w-4 h-4"}),"Save"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsxs("button",{onClick:()=>p(1),className:"w-full flex items-center justify-between p-4 bg-slate-50 hover:bg-slate-100 transition-colors",children:[e.jsx("span",{className:"font-bold text-slate-700 flex items-center gap-2",children:"1. Basic Information"}),r[1]?e.jsx(c,{className:"w-5 h-5 text-slate-400"}):e.jsx(d,{className:"w-5 h-5 text-slate-400"})]}),r[1]&&e.jsxs("div",{className:"p-5 space-y-4 animate-fade-in",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Preacher"}),e.jsx("input",{className:"w-full p-3 bg-slate-50 border-none rounded-lg focus:ring-2 focus:ring-indigo-500",value:t.preacher,onChange:s=>l({...t,preacher:s.target.value}),placeholder:"Name of speaker"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Date"}),e.jsx("input",{type:"date",className:"w-full p-3 bg-slate-50 border-none rounded-lg focus:ring-2 focus:ring-indigo-500",value:t.note_date,onChange:s=>l({...t,note_date:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Location"}),e.jsx("input",{className:"w-full p-3 bg-slate-50 border-none rounded-lg focus:ring-2 focus:ring-indigo-500",value:t.location,onChange:s=>l({...t,location:s.target.value}),placeholder:"Event or Church"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Title"}),e.jsx("input",{className:"w-full p-3 bg-slate-50 border-none rounded-lg focus:ring-2 focus:ring-indigo-500 text-lg font-bold text-slate-800",value:t.sermon_title,onChange:s=>l({...t,sermon_title:s.target.value}),placeholder:"Sermon Title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Main Scripture(s)"}),e.jsx("input",{className:"w-full p-3 bg-slate-50 border-none rounded-lg focus:ring-2 focus:ring-indigo-500",value:t.main_scripture,onChange:s=>l({...t,main_scripture:s.target.value}),placeholder:"e.g. John 3:16"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsxs("button",{onClick:()=>p(2),className:"w-full flex items-center justify-between p-4 bg-slate-50 hover:bg-slate-100 transition-colors",children:[e.jsx("span",{className:"font-bold text-slate-700 flex items-center gap-2",children:"2. Opening & Context"}),r[2]?e.jsx(c,{className:"w-5 h-5 text-slate-400"}):e.jsx(d,{className:"w-5 h-5 text-slate-400"})]}),r[2]&&e.jsxs("div",{className:"p-5 space-y-4 animate-fade-in",children:[e.jsx(o,{label:"Opening Remarks / Story",value:t.opening_remarks,onChange:s=>l({...t,opening_remarks:s})}),e.jsx(o,{label:"Context of Passage",value:t.passage_context,onChange:s=>l({...t,passage_context:s})}),e.jsx(o,{label:"Key Themes (Bullets)",value:t.key_themes,onChange:s=>l({...t,key_themes:s})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-indigo-100 overflow-hidden",children:[e.jsxs("button",{onClick:()=>p(3),className:"w-full flex items-center justify-between p-4 bg-indigo-50 hover:bg-indigo-100 transition-colors",children:[e.jsxs("span",{className:"font-bold text-indigo-900 flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4"})," 3. Sermon Structure"]}),r[3]?e.jsx(c,{className:"w-5 h-5 text-indigo-400"}):e.jsx(d,{className:"w-5 h-5 text-indigo-400"})]}),r[3]&&e.jsxs("div",{className:"p-5 space-y-6 animate-fade-in bg-slate-50/50",children:[(T=t.points)==null?void 0:T.map((s,a)=>{var i;return e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("span",{className:"bg-indigo-100 text-indigo-700 text-xs font-bold px-2 py-1 rounded",children:["Point ",a+1]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>L(a,"up"),disabled:a===0,className:"p-1 hover:bg-slate-100 rounded text-slate-400 disabled:opacity-30",children:e.jsx(c,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>L(a,"down"),disabled:a===(((i=t.points)==null?void 0:i.length)||0)-1,className:"p-1 hover:bg-slate-100 rounded text-slate-400 disabled:opacity-30",children:e.jsx(d,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Q(a),className:"p-1 hover:bg-red-50 text-slate-400 hover:text-red-500 rounded",children:e.jsx(U,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(o,{label:"Main Point",value:s.main_point,onChange:n=>b(a,"main_point",n),rows:2}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase",children:"Scripture"}),e.jsx("input",{className:"w-full p-2 bg-slate-50 border rounded text-sm",value:s.supporting_scripture,onChange:n=>b(a,"supporting_scripture",n.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase",children:"Emphasis"}),e.jsx("input",{className:"w-full p-2 bg-slate-50 border rounded text-sm",value:s.ministry_emphasis,onChange:n=>b(a,"ministry_emphasis",n.target.value)})]})]}),e.jsx(o,{label:"Quotes / Insights",value:s.key_quotes,onChange:n=>b(a,"key_quotes",n),rows:2}),e.jsx(o,{label:"Illustrations",value:s.illustrations,onChange:n=>b(a,"illustrations",n),rows:2})]})]},a)}),e.jsxs("button",{onClick:R,className:"w-full py-3 border-2 border-dashed border-indigo-200 rounded-xl text-indigo-500 font-bold hover:bg-indigo-50 transition-colors flex justify-center items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5"})," Add Main Point"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsxs("button",{onClick:()=>p(4),className:"w-full flex items-center justify-between p-4 bg-slate-50 hover:bg-slate-100 transition-colors",children:[e.jsx("span",{className:"font-bold text-slate-700",children:"4. Theological Highlights"}),r[4]?e.jsx(c,{className:"w-5 h-5 text-slate-400"}):e.jsx(d,{className:"w-5 h-5 text-slate-400"})]}),r[4]&&e.jsxs("div",{className:"p-5 space-y-4 animate-fade-in",children:[e.jsx(o,{label:"Key Doctrines Taught",value:t.key_doctrines,onChange:s=>l({...t,key_doctrines:s})}),e.jsx(o,{label:"Theological Strengths",value:t.theological_strengths,onChange:s=>l({...t,theological_strengths:s})}),e.jsx(o,{label:"Areas for Study / Clarification",value:t.theological_questions,onChange:s=>l({...t,theological_questions:s})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsxs("button",{onClick:()=>p(5),className:"w-full flex items-center justify-between p-4 bg-slate-50 hover:bg-slate-100 transition-colors",children:[e.jsx("span",{className:"font-bold text-slate-700",children:"5. Preaching Style & Delivery"}),r[5]?e.jsx(c,{className:"w-5 h-5 text-slate-400"}):e.jsx(d,{className:"w-5 h-5 text-slate-400"})]}),r[5]&&e.jsxs("div",{className:"p-5 space-y-4 animate-fade-in",children:[e.jsx(o,{label:"Tone & Atmosphere",value:t.tone_atmosphere,onChange:s=>l({...t,tone_atmosphere:s})}),e.jsx(o,{label:"Use of Scripture",value:t.use_of_scripture,onChange:s=>l({...t,use_of_scripture:s})}),e.jsx(o,{label:"Use of Stories / Examples",value:t.use_of_stories,onChange:s=>l({...t,use_of_stories:s})}),e.jsx(o,{label:"Audience Engagement",value:t.audience_engagement,onChange:s=>l({...t,audience_engagement:s})}),e.jsx(o,{label:"Flow & Transitions",value:t.flow_transitions,onChange:s=>l({...t,flow_transitions:s})}),e.jsx(o,{label:"Memorable Phrases",value:t.memorable_phrases,onChange:s=>l({...t,memorable_phrases:s})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsxs("button",{onClick:()=>p(6),className:"w-full flex items-center justify-between p-4 bg-purple-50 hover:bg-purple-100 transition-colors",children:[e.jsx("span",{className:"font-bold text-purple-900",children:"6. Personal Reflections (Minister's Lens)"}),r[6]?e.jsx(c,{className:"w-5 h-5 text-purple-400"}):e.jsx(d,{className:"w-5 h-5 text-purple-400"})]}),r[6]&&e.jsxs("div",{className:"p-5 space-y-4 animate-fade-in",children:[e.jsx(o,{label:"Ministerial Lessons Learned",value:t.minister_lessons,onChange:s=>l({...t,minister_lessons:s})}),e.jsx(o,{label:"Personal Challenge / Blessing",value:t.personal_challenge,onChange:s=>l({...t,personal_challenge:s})}),e.jsx(o,{label:"Application to my Preaching",value:t.application_to_preaching,onChange:s=>l({...t,application_to_preaching:s})}),e.jsx(o,{label:"Pastoral Insights",value:t.pastoral_insights,onChange:s=>l({...t,pastoral_insights:s})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsxs("button",{onClick:()=>p(7),className:"w-full flex items-center justify-between p-4 bg-slate-50 hover:bg-slate-100 transition-colors",children:[e.jsx("span",{className:"font-bold text-slate-700",children:"7. Application & Response"}),r[7]?e.jsx(c,{className:"w-5 h-5 text-slate-400"}):e.jsx(d,{className:"w-5 h-5 text-slate-400"})]}),r[7]&&e.jsxs("div",{className:"p-5 space-y-4 animate-fade-in",children:[e.jsx(o,{label:"Calls to Action",value:t.calls_to_action,onChange:s=>l({...t,calls_to_action:s})}),e.jsx(o,{label:"Spiritual Challenges",value:t.spiritual_challenges,onChange:s=>l({...t,spiritual_challenges:s})}),e.jsx(o,{label:"Practical Applications",value:t.practical_applications,onChange:s=>l({...t,practical_applications:s})}),e.jsx(o,{label:"Prayer Points",value:t.prayer_points,onChange:s=>l({...t,prayer_points:s})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsxs("button",{onClick:()=>p(8),className:"w-full flex items-center justify-between p-4 bg-slate-50 hover:bg-slate-100 transition-colors",children:[e.jsx("span",{className:"font-bold text-slate-700",children:"8. Closing"}),r[8]?e.jsx(c,{className:"w-5 h-5 text-slate-400"}):e.jsx(d,{className:"w-5 h-5 text-slate-400"})]}),r[8]&&e.jsxs("div",{className:"p-5 space-y-4 animate-fade-in",children:[e.jsx(o,{label:"Closing Scripture / Benediction",value:t.closing_scripture,onChange:s=>l({...t,closing_scripture:s}),rows:2}),e.jsx(o,{label:"Summary of Central Message",value:t.central_message_summary,onChange:s=>l({...t,central_message_summary:s})}),e.jsx(o,{label:"Final Memorable Line",value:t.final_memorable_line,onChange:s=>l({...t,final_memorable_line:s}),rows:2})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsxs("button",{onClick:()=>p(9),className:"w-full flex items-center justify-between p-4 bg-green-50 hover:bg-green-100 transition-colors",children:[e.jsx("span",{className:"font-bold text-green-900",children:"9. Follow-Up (For Minister)"}),r[9]?e.jsx(c,{className:"w-5 h-5 text-green-600"}):e.jsx(d,{className:"w-5 h-5 text-green-600"})]}),r[9]&&e.jsxs("div",{className:"p-5 space-y-4 animate-fade-in",children:[e.jsx(o,{label:"Scripture to Study Deeper",value:t.followup_scriptures,onChange:s=>l({...t,followup_scriptures:s})}),e.jsx(o,{label:"Topics for Future Sermons",value:t.followup_topics,onChange:s=>l({...t,followup_topics:s})}),e.jsx(o,{label:"People to Follow Up With",value:t.followup_people,onChange:s=>l({...t,followup_people:s})}),e.jsx(o,{label:"Ideas for Ministry/Leadership",value:t.followup_ministry_ideas,onChange:s=>l({...t,followup_ministry_ideas:s})})]})]})]})]})},o=({label:_,value:g,onChange:w,rows:h=3})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:_}),e.jsx("textarea",{rows:h,className:"w-full p-3 bg-slate-50 border-none rounded-lg focus:ring-2 focus:ring-indigo-500 text-sm leading-relaxed",value:g||"",onChange:v=>w(v.target.value)})]});export{me as default};
