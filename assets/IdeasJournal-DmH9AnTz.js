import{r as l,j as e,b as F,a as V,d as P,X as Z}from"./index-DjP7dUMH.js";import{s as g}from"./supabaseClient-B6bhcLjp.js";import{a as ee}from"./geminiService-C5glO8G0.js";import{P as T}from"./plus-CI59d7vJ.js";import{S as te}from"./search-zNlIoLwv.js";import{S as Y}from"./sparkles-B0azafBo.js";import{P as z}from"./pen-Cr_kg-zM.js";import{T as ae}from"./trash-2-BcME0Dqw.js";import{M as O}from"./map-pin-CD9Y0iKc.js";const me=()=>{const[u,w]=l.useState([]),[n,J]=l.useState(()=>{const t=localStorage.getItem("idea-favorites");return t?JSON.parse(t):[]}),q=(t,a)=>{a&&a.stopPropagation();let r;n.includes(t)?r=n.filter(p=>p!==t):r=[...n,t],J(r),localStorage.setItem("idea-favorites",JSON.stringify(r))},[U,N]=l.useState(!0),[i,S]=l.useState(""),[c,C]=l.useState("All"),[d,k]=l.useState("All"),[x,A]=l.useState(""),[m,I]=l.useState(""),[W,f]=l.useState(!1),[s,o]=l.useState({title:"",idea_date:new Date().toISOString().split("T")[0],place:"",note:""}),[b,h]=l.useState(""),[v,D]=l.useState(!1);l.useEffect(()=>{E()},[]);const E=async()=>{N(!0);const{data:t,error:a}=await g.from("ideas").select("*").order("idea_date",{ascending:!1});!a&&t&&w(t),N(!1)},G=async()=>{if(!s.note||!s.idea_date){alert("Please add at least a note and date.");return}try{if(s.id){const{error:t}=await g.from("ideas").update(s).eq("id",s.id);if(t)throw t}else{const{error:t}=await g.from("ideas").insert([s]);if(t)throw t}await E(),y()}catch(t){console.error("Error saving idea:",t),alert("Failed to save entry: "+t.message)}},Q=async(t,a)=>{if(a.stopPropagation(),!!window.confirm("Are you sure you want to permanently delete this entry?"))try{const{error:r}=await g.from("ideas").delete().eq("id",t);if(r)throw r;w(p=>p.filter(j=>j.id!==t)),window.alert("Entry deleted successfully.")}catch(r){console.error("Delete error:",r),window.alert("Failed to delete entry: "+(r.message||"Unknown error"))}},$=async()=>{if(!s.note)return;D(!0),h("");const t=await ee(s.note,s.title);h(t),D(!1)},R=()=>{o({title:"",idea_date:new Date().toISOString().split("T")[0],place:"",note:""}),h(""),f(!0)},M=t=>{o(t),h(""),f(!0)},y=()=>{f(!1)},X=l.useMemo(()=>{const t=new Set(u.map(a=>new Date(a.idea_date).getFullYear()));return Array.from(t).sort((a,r)=>r-a)},[u]),_=l.useMemo(()=>u.filter(t=>{const a=new Date(t.idea_date),r=i.toLowerCase(),p=!i||t.title&&t.title.toLowerCase().includes(r)||t.note.toLowerCase().includes(r)||t.place&&t.place.toLowerCase().includes(r),j=!x||t.idea_date>=x,B=!m||t.idea_date<=m,H=c==="All"||a.getFullYear().toString()===c,K=d==="All"||(a.getMonth()+1).toString()===d;return p&&j&&B&&H&&K}),[u,i,x,m,c,d]),L=t=>{if(t.title)return t.title;const a=t.note.split(`
`)[0];return a.length>50?a.substring(0,50)+"...":a};return e.jsxs("div",{className:"max-w-[1600px] mx-auto pb-24 h-[calc(100vh-100px)] flex flex-col",children:[e.jsxs("div",{className:"relative flex flex-col md:flex-row justify-between items-end gap-6 mb-6 overflow-visible",children:[e.jsx("div",{className:"absolute -top-10 -left-10 w-[120%] h-40 bg-gradient-to-r from-amber-200 via-pink-100 to-amber-100 opacity-60 blur-2xl rounded-3xl pointer-events-none animate-gradient-x z-0"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-amber-600 font-bold uppercase text-xs tracking-widest animate-fade-in",children:[e.jsx(F,{className:"w-4 h-4 animate-bounce"})," Ministry Thoughts"]}),e.jsx("h1",{className:"text-4xl font-serif font-bold text-gray-900 drop-shadow-sm animate-fade-in",children:"Ideas Journal"}),e.jsx("p",{className:"text-gray-500 mt-2 animate-fade-in",children:"Capture sermons, visions, and spiritual insights."})]}),e.jsxs("button",{onClick:R,className:"relative z-10 bg-amber-500 text-white px-6 py-3 rounded-full hover:bg-amber-600 flex items-center gap-2 shadow-lg hover:shadow-amber-500/30 transition-all transform active:scale-95 font-bold animate-pulse group",title:"Add a new idea entry",children:[e.jsx(T,{className:"w-5 h-5 group-hover:rotate-90 transition-transform duration-300"})," New Entry",e.jsx("span",{className:"absolute -top-2 -right-2 bg-pink-400 text-white text-xs px-2 py-0.5 rounded-full shadow animate-bounce",children:"New"})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-100 mb-6 grid grid-cols-1 md:grid-cols-12 gap-4",children:[e.jsxs("div",{className:"md:col-span-4 relative",children:[e.jsx(te,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search topics, verses...",className:"w-full pl-10 pr-4 py-2.5 bg-gray-50 border-none rounded-xl focus:ring-2 focus:ring-amber-500/50",value:i,onChange:t=>S(t.target.value)})]}),e.jsxs("div",{className:"md:col-span-8 flex flex-wrap gap-3 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-xl",children:[e.jsx(V,{className:"w-4 h-4 text-gray-400"}),e.jsx("input",{type:"date",className:"bg-transparent border-none p-0 text-sm focus:ring-0",value:x,onChange:t=>A(t.target.value)}),e.jsx("span",{className:"text-gray-400",children:"-"}),e.jsx("input",{type:"date",className:"bg-transparent border-none p-0 text-sm focus:ring-0",value:m,onChange:t=>I(t.target.value)})]}),e.jsxs("select",{className:"bg-gray-50 border-none rounded-xl py-2.5 pl-3 pr-8 text-sm focus:ring-2 focus:ring-amber-500/50",value:c,onChange:t=>C(t.target.value),children:[e.jsx("option",{value:"All",children:"All Years"}),X.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{className:"bg-gray-50 border-none rounded-xl py-2.5 pl-3 pr-8 text-sm focus:ring-2 focus:ring-amber-500/50",value:d,onChange:t=>k(t.target.value),children:[e.jsx("option",{value:"All",children:"All Months"}),Array.from({length:12},(t,a)=>e.jsx("option",{value:a+1,children:new Date(0,a).toLocaleString("default",{month:"long"})},a))]}),(i||x||m||c!=="All"||d!=="All")&&e.jsx("button",{onClick:()=>{S(""),A(""),I(""),C("All"),k("All")},className:"text-xs font-bold text-red-500 hover:bg-red-50 px-3 py-2 rounded-lg ml-auto",children:"Clear"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar",children:U?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(P,{className:"w-8 h-8 animate-spin text-amber-500"})}):_.length===0?e.jsxs("div",{className:"text-center py-20 opacity-50",children:[e.jsx(F,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg",children:"No entries found matching your filters."})]}):e.jsx("div",{className:"space-y-3",children:_.map(t=>e.jsxs("div",{onClick:()=>M(t),className:`relative bg-white p-4 rounded-2xl border border-gray-100 shadow-sm hover:shadow-lg hover:border-amber-300 transition-all cursor-pointer group flex items-start gap-4 overflow-visible ${n.includes(t.id)?"ring-2 ring-amber-400":""}`,tabIndex:0,title:L(t),children:[e.jsx("button",{className:"absolute top-2 right-2 z-10 p-1 rounded-full bg-white/80 hover:bg-amber-100 border border-amber-200 shadow transition-colors",onClick:a=>q(t.id,a),"aria-label":n.includes(t.id)?"Unfavorite":"Mark as favorite",tabIndex:0,type:"button",title:n.includes(t.id)?"Unfavorite":"Mark as favorite",children:e.jsx(Y,{className:`w-5 h-5 ${n.includes(t.id)?"text-amber-500 fill-amber-400":"text-gray-300"} transition-all`})}),e.jsxs("div",{className:"hidden md:flex flex-col items-center justify-center bg-amber-50 text-amber-800 rounded-lg p-3 min-w-[4.5rem]",children:[e.jsx("span",{className:"text-xs font-bold uppercase",children:new Date(t.idea_date).toLocaleDateString("default",{month:"short"})}),e.jsx("span",{className:"text-xl font-bold leading-none",children:new Date(t.idea_date).getDate()}),e.jsx("span",{className:"text-[10px] opacity-60",children:new Date(t.idea_date).getFullYear()})]}),e.jsx("div",{className:"md:hidden text-xs font-bold text-amber-600 whitespace-nowrap pt-1",children:new Date(t.idea_date).toLocaleDateString()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg truncate group-hover:text-amber-700 transition-colors",children:L(t)}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity pl-2",children:[e.jsx("button",{onClick:a=>{a.stopPropagation(),M(t)},className:"p-2 text-gray-400 hover:bg-gray-100 rounded-lg",title:"Edit",children:e.jsx(z,{className:"w-4 h-4"})}),e.jsx("button",{onClick:a=>Q(t.id,a),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:e.jsx(ae,{className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-gray-600 text-sm line-clamp-2 mb-2 leading-relaxed",children:t.note}),t.place&&e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-400 font-medium",children:[e.jsx(O,{className:"w-3.5 h-3.5"}),t.place]})]})]},t.id))})}),W&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-3xl shadow-2xl overflow-hidden max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-amber-50",children:[e.jsxs("h3",{className:"font-bold text-xl text-amber-900 flex items-center gap-2",children:[s.id?e.jsx(z,{className:"w-5 h-5"}):e.jsx(T,{className:"w-5 h-5"}),s.id?"Edit Entry":"New Thought"]}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Z,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-1 space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Date"}),e.jsx("input",{type:"date",className:"w-full p-3 bg-gray-50 border-none rounded-xl focus:ring-2 focus:ring-amber-500",value:s.idea_date,onChange:t=>o({...s,idea_date:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Location / Context"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-3.5 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"e.g. Prayer Walk",className:"w-full pl-9 pr-3 py-3 bg-gray-50 border-none rounded-xl focus:ring-2 focus:ring-amber-500",value:s.place||"",onChange:t=>o({...s,place:t.target.value})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Title"}),e.jsx("input",{type:"text",placeholder:"Give this thought a name...",className:"w-full p-3 bg-gray-50 border-none rounded-xl focus:ring-2 focus:ring-amber-500 text-lg font-bold text-gray-800",value:s.title||"",onChange:t=>o({...s,title:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Journal Note"}),e.jsx("textarea",{rows:8,className:"w-full p-4 bg-gray-50 border-none rounded-xl focus:ring-2 focus:ring-amber-500 leading-relaxed resize-none",placeholder:"Write your idea, scripture, or sermon outline here...",value:s.note||"",onChange:t=>o({...s,note:t.target.value})})]}),e.jsxs("div",{className:"bg-purple-50 rounded-xl p-4 border border-purple-100",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("h4",{className:"text-sm font-bold text-purple-800 flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4"})," AI Assistant"]}),s.note&&!b&&e.jsx("button",{onClick:$,disabled:v,className:"text-xs font-bold text-purple-600 hover:text-purple-800 hover:underline",children:v?"Thinking...":"Expand this thought"})]}),v?e.jsxs("div",{className:"flex items-center gap-2 text-purple-500 text-sm p-2",children:[e.jsx(P,{className:"w-4 h-4 animate-spin"})," Generating sermon outline..."]}):b?e.jsx("div",{className:"prose prose-sm prose-purple mt-2 max-h-40 overflow-y-auto custom-scrollbar",children:e.jsx("div",{className:"whitespace-pre-wrap text-slate-700",children:b})}):e.jsx("p",{className:"text-xs text-purple-400 italic",children:"Write a note above and click expand to generate a sermon outline or action plan."})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100 flex justify-end gap-3",children:[e.jsx("button",{onClick:y,className:"px-5 py-2.5 text-gray-600 font-bold hover:bg-gray-200 rounded-xl transition-colors",children:"Cancel"}),e.jsx("button",{onClick:G,className:"px-6 py-2.5 bg-gray-900 text-white font-bold hover:bg-black rounded-xl shadow-lg transition-transform active:scale-95",children:"Save Entry"})]})]})})]})};export{me as default};
